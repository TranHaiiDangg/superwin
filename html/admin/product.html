<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Quản lý sản phẩm</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">Admin Panel</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="dashboard.html">Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="product.html">Quản lý sản phẩm</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="orders.html">Đơn hàng</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="users.html">Người dùng</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="container mt-5">
    <h2 class="mb-4">Danh sách sản phẩm</h2>
    <button class="btn btn-success mb-3" id="btnAdd">Thêm sản phẩm</button>
    <table class="table table-bordered table-hover" id="productTable">
      <thead class="table-dark">
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Tên sản phẩm</th>
          <th scope="col">Giá</th>
          <th scope="col">Số lượng</th>
          <th scope="col">Hành động</th>
        </tr>
      </thead>
      <tbody id="tbodyProduct">
        <tr>
          <td>1</td>
          <td>Sản phẩm A</td>
          <td>100.000đ</td>
          <td>50</td>
          <td>
            <button class="btn btn-sm btn-primary btnEdit">Sửa</button>
            <button class="btn btn-sm btn-danger btnDelete">Xóa</button>
          </td>
        </tr>
        <tr>
          <td>2</td>
          <td>Sản phẩm B</td>
          <td>200.000đ</td>
          <td>30</td>
          <td>
            <button class="btn btn-sm btn-primary btnEdit">Sửa</button>
            <button class="btn btn-sm btn-danger btnDelete">Xóa</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal Thêm/Sửa Sản phẩm -->
  <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="productModalLabel">Thêm sản phẩm</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="productForm">
            <input type="hidden" id="productId">
            <div class="mb-3">
              <label for="productName" class="form-label">Tên sản phẩm</label>
              <input type="text" class="form-control" id="productName" required>
            </div>
            <div class="mb-3">
              <label for="productPrice" class="form-label">Giá</label>
              <input type="text" class="form-control" id="productPrice" required>
            </div>
            <div class="mb-3">
              <label for="productQty" class="form-label">Số lượng</label>
              <input type="number" class="form-control" id="productQty" required min="1">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
          <button type="submit" class="btn btn-primary" id="saveProduct">Lưu</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    let editingRow = null;
    let productIdCounter = 3;

    // Mở modal thêm sản phẩm
    document.getElementById('btnAdd').onclick = function() {
      editingRow = null;
      document.getElementById('productModalLabel').innerText = 'Thêm sản phẩm';
      document.getElementById('productForm').reset();
      document.getElementById('productId').value = '';
      const modal = new bootstrap.Modal(document.getElementById('productModal'));
      modal.show();
    };

    // Lưu sản phẩm (thêm mới hoặc cập nhật)
    document.getElementById('saveProduct').onclick = function(e) {
      e.preventDefault();
      const name = document.getElementById('productName').value.trim();
      const price = document.getElementById('productPrice').value.trim();
      const qty = document.getElementById('productQty').value.trim();
      if (!name || !price || !qty) {
        alert('Vui lòng nhập đầy đủ thông tin!');
        return;
      }
      if (editingRow) {
        // Sửa
        editingRow.cells[1].innerText = name;
        editingRow.cells[2].innerText = price;
        editingRow.cells[3].innerText = qty;
      } else {
        // Thêm mới
        const tbody = document.getElementById('tbodyProduct');
        const row = tbody.insertRow();
        row.insertCell(0).innerText = productIdCounter++;
        row.insertCell(1).innerText = name;
        row.insertCell(2).innerText = price;
        row.insertCell(3).innerText = qty;
        const actionCell = row.insertCell(4);
        actionCell.innerHTML = '<button class="btn btn-sm btn-primary btnEdit">Sửa</button> <button class="btn btn-sm btn-danger btnDelete">Xóa</button>';
      }
      bootstrap.Modal.getInstance(document.getElementById('productModal')).hide();
      attachRowEvents();
    };

    // Gán sự kiện cho nút Sửa/Xóa
    function attachRowEvents() {
      document.querySelectorAll('.btnEdit').forEach(btn => {
        btn.onclick = function() {
          editingRow = this.closest('tr');
          document.getElementById('productModalLabel').innerText = 'Sửa sản phẩm';
          document.getElementById('productName').value = editingRow.cells[1].innerText;
          document.getElementById('productPrice').value = editingRow.cells[2].innerText;
          document.getElementById('productQty').value = editingRow.cells[3].innerText;
          const modal = new bootstrap.Modal(document.getElementById('productModal'));
          modal.show();
        };
      });
      document.querySelectorAll('.btnDelete').forEach(btn => {
        btn.onclick = function() {
          if (confirm('Bạn có chắc muốn xóa sản phẩm này?')) {
            this.closest('tr').remove();
          }
        };
      });
    }
    attachRowEvents();
  </script>
</body>
</html>
