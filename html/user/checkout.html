<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thanh Toán</title>
    
    <style>
            
        * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    /* ===== MOBILE-FIRST BASE STYLES ===== */
    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        line-height: 1.6;
        color: #212529;
        background-color: #ffffff;
        overflow-x: hidden;
        font-size: 16px;
        padding-top: 60px; 
    }

        input,
        textarea,
        select {
        font-size: inherit;
    }
    </style>
    <meta name="theme-color" content="#4facfe">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        /* ==========================================================================
   COMBINED CSS - MODAL & CHECKOUT PAGE STYLES
   ========================================================================== */

/* ==========================================================================
   HEADER SECTION
   ========================================================================== */
.header {
    width: 100%;
    background: #4facfe;
    color: white;
    padding: 15px 0;
    text-align: center;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1000;
}

.header-content {
    max-width: 1280px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    padding: 0 20px;
}

.logo-link {
    position: absolute;
    left: 30px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    align-items: center;
}

.logo-link img {
    height: 40px;
}

.back-button {
    position: absolute;
    left: 20px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: background-color 0.3s ease;
    display: none;
}

.back-button:hover {
    background-color: rgba(255, 255, 255, 0.2);
}

.header h2 {
    margin: 0 auto;
    font-size: 20px;
}

/* ==========================================================================
   LAYOUT SECTION
   ========================================================================== */
.container {
    max-width: 1280px;
    margin: 0 auto;
    padding: 20px;
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 30px;
}

/* ==========================================================================
   MODAL STYLES (Enhanced to avoid conflicts)
   ========================================================================== */
.modal {
    display: none;
    position: fixed;
    z-index: 2000; /* Higher than header */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(2px);
    animation: fadeIn 0.3s ease;
}

.modal.show {
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-content {
    background: white;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    position: relative;
    margin: 20px;
}

/* Modal Header */
.modal-header {
    padding: 20px 24px 16px;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-title {
    font-size: 18px;
    font-weight: 600;
    margin: 0;
    color: #333;
}

.modal .close-btn {
    background: none;
    border: none;
    font-size: 24px;
    color: #666;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.2s ease;
}

.modal .close-btn:hover {
    background-color: #f5f5f5;
    color: #333;
}

/* Invoice Type Toggle (Modal specific) */
.modal .invoice-type-toggle {
    padding: 0 24px;
    margin-bottom: 20px;
    display: flex;
    gap: 20px;
}

.modal .invoice-type-toggle label {
    display: flex;
    align-items: center;
    cursor: pointer;
    font-weight: 500;
    color: #333;
}

.modal .invoice-type-toggle input[type="radio"] {
    margin-right: 8px;
    transform: scale(1.1);
}

/* Modal Form Styles */
.modal #invoiceForm {
    padding: 0 24px;
}

.modal .form-group {
    margin-bottom: 16px;
}

.modal .form-control {
    width: 100%;
    padding: 12px 16px;
    border: 1.5px solid #e1e5e9;
    border-radius: 8px;
    font-size: 14px;
    background: #fafbfc;
    transition: all 0.2s ease;
    box-sizing: border-box;
}

.modal .form-control:focus {
    outline: none;
    border-color: #007bff;
    background: white;
    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
}

.modal .form-control::placeholder {
    color: #999;
    font-weight: normal;
}

.modal textarea.form-control {
    resize: vertical;
    min-height: 80px;
    font-family: inherit;
}

/* Modal Checkbox Group */
.modal .checkbox-group {
    margin-bottom: 16px;
}

.modal .checkbox-group label {
    display: flex;
    align-items: center;
    cursor: pointer;
    font-size: 14px;
    color: #555;
}

.modal .checkbox-group input[type="checkbox"] {
    margin-right: 8px;
    transform: scale(1.1);
}

/* Warning Message (Modal specific) */
.modal .warning-message {
    background: #fff8e1;
    border: 1px solid #ffcc02;
    border-radius: 8px;
    padding: 16px;
}

.modal .warning-message > div:first-child {
    color: #f57c00;
    font-weight: 600;
    margin-bottom: 8px;
    font-size: 14px;
}

.modal .warning-message ul {
    margin: 0;
    padding-left: 18px;
    color: #e65100;
    font-size: 13px;
    line-height: 1.4;
}

.modal .warning-message li {
    margin-bottom: 6px;
}

.modal .warning-message li:last-child {
    margin-bottom: 0;
}

.modal .warning-message strong {
    color: #d84315;
    font-weight: 600;
}

/* Modal Actions */
.modal-actions {
    padding: 20px 24px;
    border-top: 1px solid #f0f0f0;
    display: flex;
    justify-content: flex-end;
    gap: 12px;
}

/* Modal Section Title */
.modal .section-title {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    font-weight: 500;
    color: #333;
}

.modal .section-title .btn-link {
    color: #007bff;
    font-weight: 500;
    text-decoration: none;
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.modal .section-title .btn-link:hover {
    background-color: rgba(0, 123, 255, 0.1);
}

/* Invoice Display (Modal specific) */
.modal #invoiceDisplay {
    margin-bottom: 20px;
    padding: 16px;
    border: 1.5px solid #e1e5e9;
    border-radius: 8px;
    background: #f8f9fa;
}

.modal #invoiceContent div {
    margin-bottom: 6px;
    font-size: 14px;
    line-height: 1.4;
}

.modal #invoiceContent div:first-child {
    font-weight: 600;
    color: #333;
    margin-bottom: 12px;
}

.modal #invoiceContent strong {
    font-weight: 500;
    color: #555;
}

/* ==========================================================================
   CHECKOUT FORM SECTION
   ========================================================================== */
.checkout-form {
    background: white;
    border-radius: 12px;
    padding: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

/* Section Title (Checkout page specific) */
.checkout-form .section-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: #007bff;
    border-bottom: 2px solid #e0e0e0;
    padding-bottom: 10px;
}

/* ==========================================================================
   BUTTON STYLES
   ========================================================================== */
.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s ease;
    min-width: 80px;
}

.btn-primary {
    background: #007bff;
    color: white;
}

.btn-primary:hover {
    background: #0056b3;
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #5a6268;
}

.btn-link {
    background: none;
    color: #007bff;
    text-decoration: underline;
    font-size: 14px;
}

/* Checkout specific buttons */
.checkout-btn {
    width: 100%;
    padding: 15px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    margin-top: 20px;
    transition: background 0.3s ease;
    background: #007bff;
    color: white;
}

.checkout-btn:hover {
    background: #0056b3;
}

/* ==========================================================================
   ADDRESS SECTION
   ========================================================================== */
.address-section {
    margin-bottom: 30px;
}

.address-card {
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    padding: 15px;
    background: #f9f9f9;
    position: relative;
}

.address-card.selected {
    border-color: #007bff;
    background: #e3f2fd;
}

.address-info h4 {
    font-size: 16px;
    margin-bottom: 5px;
    color: #333;
}

.address-info p {
    color: #666;
    font-size: 14px;
    margin-bottom: 3px;
}

.address-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.address-tags {
    display: flex;
    gap: 5px;
    margin-top: 8px;
}

.address-tag {
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
}

.tag-home {
    background: #e3f2fd;
    color: #007bff;
}

.tag-default {
    background: #fff3cd;
    color: #856404;
}

.address-list {
    max-height: 300px;
    overflow-y: auto;
}

.address-item {
    padding: 15px;
    border: 1px solid #eee;
    border-radius: 8px;
    margin-bottom: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.address-item:hover {
    background: #f9f9f9;
}

.address-item.selected {
    border-color: #007bff;
    background: #e3f2fd;
}

.address-item h4 {
    margin-bottom: 5px;
    color: #333;
}

.address-item p {
    color: #666;
    font-size: 14px;
    margin-bottom: 3px;
}

.address-type-toggle {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.toggle-btn {
    padding: 8px 16px;
    border: 1px solid #ddd;
    background: white;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
}

.toggle-btn.active {
    background: #007bff;
    color: white;
    border-color: #007bff;
}

/* ==========================================================================
   ORDER SUMMARY SECTION
   ========================================================================== */
.order-summary {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    height: fit-content;
    position: sticky;
    top: 20px;
}

.product-item {
    display: flex;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #eee;
}

.product-image {
    width: 60px;
    height: 60px;
    background: #f0f0f0;
    border-radius: 8px;
    margin-right: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #999;
}

.product-details {
    flex: 1;
}

.product-name {
    font-size: 14px;
    margin-bottom: 5px;
}

.product-price {
    color: #007bff;
    font-weight: 600;
}

.summary-row {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
}

.summary-row.total {
    border-top: 2px solid #eee;
    padding-top: 15px;
    font-weight: 600;
    font-size: 18px;
    color: #007bff;
}

/* ==========================================================================
   INVOICE SECTION
   ========================================================================== */
.invoice-section {
    margin-top: 20px;
    margin-bottom: 20px;
    padding: 15px;
    background: #f9f9f9;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
}

.invoice-toggle {
    display: flex;
    align-items: center;
    gap: 10px;
}

.invoice-toggle input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: #007bff;
}

.invoice-toggle label {
    font-size: 14px;
    color: #333;
    cursor: pointer;
}

.invoice-link {
    color: #007bff;
    text-decoration: underline;
    cursor: pointer;
    font-size: 14px;
    margin-left: 5px;
}

/* Invoice modal specific styles */
.invoice-modal .modal-content {
    max-width: 600px;
    height: 600px;
}

.invoice-modal textarea {
    min-height: 100px;
    resize: vertical;
}

/* ==========================================================================
   PAYMENT SECTION
   ========================================================================== */
.payment-section {
    margin-bottom: 30px;
}

.payment-option {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    cursor: pointer;
    margin-bottom: 10px;
}

.payment-option:hover {
    background: #f9f9f9;
}

/* ==========================================================================
   FORM ELEMENTS
   ========================================================================== */
.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #333;
}

.form-label.required::after {
    content: " *";
    color: #e74c3c;
}

/* General form control styles (non-modal) */
.checkout-form .form-control,
.form-control:not(.modal .form-control) {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    transition: border-color 0.3s ease;
}

.checkout-form .form-control:focus,
.form-control:not(.modal .form-control):focus {
    outline: none;
    border-color: #007bff;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
}

.form-control:disabled {
    background: #f5f5f5;
    color: #999;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.form-hint {
    font-size: 12px;
    color: #666;
    margin-top: 5px;
    font-style: italic;
}

/* Radio buttons styling */
.radio-group {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
}

.radio-option {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.radio-option input[type="radio"] {
    width: 18px;
    height: 18px;
    accent-color: #007bff;
}

.radio-option label {
    font-size: 14px;
    color: #333;
    cursor: pointer;
}

/* Checkbox Group (non-modal) */
.checkout-form .checkbox-group {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 15px;
}

/* ==========================================================================
   NOTES SECTION
   ========================================================================== */
.notes-section textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    resize: vertical;
    font-family: inherit;
}

.notes-section textarea:focus {
    outline: none;
    border-color: #007bff;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
}

/* ==========================================================================
   NOTICE & WARNING BOXES
   ========================================================================== */
.notice-box {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 6px;
    padding: 15px;
    margin-bottom: 20px;
}

.notice-box h4 {
    color: #856404;
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 10px;
}

.notice-list {
    list-style: none;
    padding: 0;
}

.notice-list li {
    color: #856404;
    font-size: 13px;
    margin-bottom: 5px;
    position: relative;
    padding-left: 15px;
}

.notice-list li::before {
    content: "•";
    color: #f39c12;
    font-weight: bold;
    position: absolute;
    left: 0;
}

/* ==========================================================================
   TOGGLE SWITCH
   ========================================================================== */
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
    margin-left: 10px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 24px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: #28a745;
}

input:checked + .slider:before {
    transform: translateX(26px);
}

/* ==========================================================================
   CONFIRMATION MODAL
   ========================================================================== */
.confirmation-modal .modal-content {
    text-align: center;
    max-width: 400px;
}

.confirmation-icon {
    width: 60px;
    height: 60px;
    background: #007bff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
    margin: 0 auto 20px;
}

/* ==========================================================================
   MOBILE CHECKOUT BAR
   ========================================================================== */
.mobile-checkout-bar {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    background: #fff;
    box-shadow: 0 -2px 12px rgba(0,0,0,0.08);
    z-index: 100;
    padding: 12px 16px 16px 16px;
    border-top: 1px solid #eee;
}

.mobile-checkout-bar .summary-row.total {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    margin-bottom: 0;
    border: none;
    padding: 0;
}

.mobile-checkout-bar .summary-row.total .label {
    font-size: 13px;
    color: #222;
    font-weight: 400;
    display: block;
    margin-bottom: 2px;
}

/* ==========================================================================
   ANIMATIONS
   ========================================================================== */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ==========================================================================
   RESPONSIVE DESIGN
   ========================================================================== */

/* Tablet and mobile - Header */
@media screen and (max-width: 768px) {
    body {
        padding-top: 45px;
    }
    
    .logo-link {
        display: none;
    }
    
    .back-button {
        display: block;
    }

    .header-content {
        padding: 0 15px;
    }

    .header h2 {
        font-size: 18px;
    }

    /* Layout adjustments */
    .container {
        grid-template-columns: 1fr;
        padding: 15px;
        padding-bottom: 110px !important;
    }

    .form-row {
        grid-template-columns: 1fr;
    }

    /* Modal adjustments */
    .modal-content {
        margin: 20px;
        width: calc(100% - 40px);
    }

    /* Order summary adjustments */
    .order-summary {
        position: static;
        padding-bottom: 0;
    }

    /* Mobile checkout bar */
    .mobile-checkout-bar {
        display: flex;
    }

    .mobile-checkout-bar .summary-row.total span:first-child,
    .desktop-total span:first-child {
        font-size: 13px;
        color: #222;
        font-weight: 400;
        display: block;
        margin-bottom: 2px;
    }

    .mobile-checkout-bar .checkout-btn {
        width: auto;
        min-width: 120px;
        margin-top: 0;
        font-size: 16px;
        margin-left: 16px;
        flex-shrink: 0;
    }

    .desktop-total,
    .desktop-checkout {
        display: none !important;
    }

    .radio-group {
        flex-direction: column;
        gap: 10px;
    }

    /* Modal mobile specific styles */
    .modal-content {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100% !important;
        height: 100% !important;
        max-width: none !important;
        max-height: none !important;
        border-radius: 0 !important;
        margin: 0 !important;
        transform: none !important;
    }
    
    .modal-header {
        padding: 16px 20px;
        position: sticky;
        top: 0;
        background: white;
        z-index: 10;
    }
    
    .modal-title {
        font-size: 16px;
    }
    
    .modal #invoiceForm {
        padding: 0 20px;
    }
    
    
    .modal-actions {
        padding: 16px 20px;
        position: sticky;
        bottom: 0;
        background: white;
        z-index: 10;
    }
    
    .modal .invoice-type-toggle {
        padding: 0 20px;
        flex-direction: column;
        gap: 12px;
    }
}

/* Small mobile */
@media screen and (max-width: 480px) {
    .header {
        padding: 12px 0;
    }

    .back-button {
        left: 15px;
        font-size: 20px;
    }

    .header h2 {
        font-size: 16px;
    }
}

/* Desktop - Hide mobile checkout bar */
@media (min-width: 769px) {
    .mobile-checkout-bar {
        display: none !important;
    }
}
    </style>
</head>
<body>

    <div class="header">
        <div class="header-content">
            <!-- Logo cho desktop -->
            <a href="/Trang_Chu/index.html" class="logo-link">
                <img src="/image/logo.png" alt="Logo">
            </a>
            
            <!-- Nút quay lại cho mobile/tablet -->
            <button class="back-button" onclick="goBack()">
                ←
            </button>
            
            <h2>Thanh toán đơn hàng</h2>
        </div>
    </div>

    <div class="container">
        <div class="checkout-form">
            <!-- Địa chỉ nhận hàng -->
            <div class="address-section">
                <div class="section-title">Địa chỉ nhận hàng</div>
                <div class="address-card selected" id="currentAddress">
                    <div class="address-info">
                        <h4>Trần Đăng - 0915378844</h4>
                        <p>4449, Nguyễn Cửu Phú, Phường Tân Tạo A, Quận Bình Tân, Hồ Chí Minh</p>
                        <div class="address-tags">
                            <span class="address-tag tag-home">Nhà riêng</span>
                            <span class="address-tag tag-default">Địa chỉ mặc định</span>
                        </div>
                    </div>
                    <div class="address-actions">
                        <button class="btn btn-link" onclick="openAddressModal()">Thay đổi</button>
                    </div>
                </div>
            </div>

            <!-- Phương thức thanh toán -->
            <div class="section-title">Phương thức thanh toán</div>
            <div style="margin-bottom: 30px;">
                <label style="display: flex; align-items: center; gap: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; margin-bottom: 10px;">
                    <input type="radio" name="payment" value="cod" checked>
                    <span>Thanh toán khi nhận hàng (COD)</span>
                </label>
                <label style="display: flex; align-items: center; gap: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer;">
                    <input type="radio" name="payment" value="vnpay">
                    <span>Thanh toán trực tuyến (VNPAY)</span>
                </label>
            </div>

            <!-- Ghi chú -->
            <div class="section-title">Ghi chú đơn hàng</div>
            <textarea class="form-control" rows="3" placeholder="Nhập ghi chú cho đơn hàng (không bắt buộc)"></textarea>
        </div>

        <!-- Tóm tắt đơn hàng -->
        <div class="order-summary">
            <div class="section-title" style="display: flex; justify-content: space-between; align-items: center;">
                <span>Đơn hàng của bạn</span>
                <a href="/Cart/cart.html" class="btn btn-link" style="color: #007bff; font-weight: 500; text-decoration: none;">Thay đổi</a>
            </div>

            <!-- Thêm vào phần checkout-form, sau phần "Phương thức thanh toán" -->
<div class="section-title" style="display: flex; justify-content: space-between; align-items: center;">
    <span>Thông tin xuất hóa đơn</span>
    <button class="btn btn-link" onclick="openInvoiceModal()" style="color: #007bff; font-weight: 500; text-decoration: none; background: none; border: none; cursor: pointer;">Nhập</button>
</div>

<!-- Invoice Information Display -->
<div id="invoiceDisplay" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f8f9fa; display: none;">
    <div id="invoiceContent"></div>
</div>

<!-- Modal thông tin xuất hóa đơn -->
<div id="invoiceModal" class="modal">
    <div class="modal-content" id="invoiceModalContent">
        <div class="modal-header">
            <h3 class="modal-title">Thông tin xuất hóa đơn</h3>
            <button class="close-btn" onclick="closeInvoiceModal()">&times;</button>
        </div>

        <!-- Invoice Type Toggle -->
        <div class="invoice-type-toggle" style="margin-bottom: 20px; margin-top: 10px;">
            <label style="display: flex; align-items: center; margin-right: 20px; cursor: pointer;">
                <input type="radio" name="invoiceType" value="company" onchange="toggleInvoiceType()" style="margin-right: 8px;">
                <span>Công ty</span>
            </label>
            <label style="display: flex; align-items: center; cursor: pointer;">
                <input type="radio" name="invoiceType" value="individual" onchange="toggleInvoiceType()" checked style="margin-right: 8px;">
                <span>Cá nhân</span>
            </label>
        </div>

        <form id="invoiceForm">
            <!-- Company Fields -->
            <div id="companyFields" style="display: none;">
                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="text" class="form-control" id="taxCode" placeholder="Mã số thuế" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="text" class="form-control" id="companyName" placeholder="Tên công ty" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <textarea class="form-control" id="companyAddress" rows="3" placeholder="Nhập địa chỉ (bao gồm Phường/Xã, Quận/Huyện, Tỉnh/Thành phố nếu có)" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa; resize: vertical;"></textarea>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="email" class="form-control" id="companyEmail" placeholder="Email nhận hóa đơn" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
            </div>

            <!-- Individual Fields -->
            <div id="individualFields">
                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="text" class="form-control" id="individualTaxCode" placeholder="Mã số thuế" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="text" class="form-control" id="individualName" placeholder="Trần Hải Đăng" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="text" class="form-control" id="individualId" placeholder="Số CCCD" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="tel" class="form-control" id="individualPhone" placeholder="Số điện thoại" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <textarea class="form-control" id="individualAddress" rows="3" placeholder="Nhập địa chỉ (bao gồm Phường/Xã, Quận/Huyện, Tỉnh/Thành phố nếu có)" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa; resize: vertical;"></textarea>
                </div>
                
                <!-- Use delivery address toggle -->
                <div class="checkbox-group" style="margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="useDeliveryAddress" onchange="toggleDeliveryAddress()" style="margin-right: 8px;">
                        <span>Sử dụng địa chỉ giao hàng</span>
                    </label>
                </div>

                <div class="form-group" style="margin-bottom: 15px;">
                    <input type="email" class="form-control" id="individualEmail" placeholder="Email nhận hóa đơn" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                </div>
            </div>

            <!-- Warning Message -->
            <div class="warning-message" style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 15px; margin-bottom: 20px;">
                <div style="color: #856404; font-weight: 500; margin-bottom: 8px;">Lưu ý</div>
                <ul style="margin: 0; padding-left: 20px; color: #856404; font-size: 14px;">
                    <li style="margin-bottom: 4px;"><strong style="color: #e17055;">Quý khách hàng vui lòng nhập địa chỉ theo tên đơn vị hành chính mới. SUPERWIN sẽ không chịu trách nhiệm điều chỉnh hóa đơn nếu thông tin do khách hàng cung cấp bị sai sót.</strong></li>
                    <li style="margin-bottom: 4px;">Để trống mã số thuế đối với Cá nhân không có mã số thuế</li>
                    <li>Không xuất hóa đơn cho các đơn hàng mua Phiếu mua hàng SuperWin</li>
                </ul>
            </div>
        </form>

        <div class="modal-actions">
            <button class="btn btn-secondary" onclick="closeInvoiceModal()" style="padding: 12px 24px; margin-right: 10px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">Hủy</button>
            <button class="btn btn-primary" onclick="saveInvoiceInfo()" style="padding: 12px 24px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Hoàn tất</button>
        </div>
    </div>
</div>
            
            <div class="product-item">
                <img class="product-image" src="/Trang_Chu/image/sp1.png" alt="Máy bơm nước Super Win 3 HP">
                <div class="product-details">
                    <div class="product-name">Máy bơm nước Super Win 3 HP</div>
                    <div class="product-price">4.450.000₫ x 2</div>
                </div>
            </div>

            <div class="product-item">
                <img class="product-image" src="/Trang_Chu/image/sp1.png" alt="Máy bơm nước Super Win 3 HP">
                <div class="product-details">
                    <div class="product-name">Máy bơm nước Super Win 3 HP</div>
                    <div class="product-price">4.450.000₫ x 1</div>
                </div>
            </div>

            <div class="summary-row">
                <span>Tạm tính:</span>
                <span>8.900.000₫</span>
            </div>
            <div class="summary-row">
                <span>Phí vận chuyển:</span>
                <span>30.000₫</span>
            </div>
            <div class="summary-row">
                <span>Giảm giá:</span>
                <span style="color: #e74c3c;">-50.000₫</span>
            </div>
            <div class="summary-row">
                <span>Thuế VAT (8%):</span>
                <span>712.000₫</span>
            </div>
            <div class="summary-row total desktop-total">
                <span>Tổng cộng(Đã VAT)</span>
                <span>737.000₫</span>
            </div>
            <button class="checkout-btn desktop-checkout">Đặt hàng</button>
        </div>
        <!-- Bar cố định cho mobile -->
        <div class="mobile-checkout-bar">
            <div class="summary-row total">
                <span class="label">Tổng cộng (Đã VAT)</span>
                <span class="price">737.000₫</span>
            </div>
            <button class="checkout-btn">Đặt hàng</button>
        </div>
    </div>

    <!-- Modal chọn địa chỉ -->
    <div id="addressModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Địa chỉ nhận hàng</h3>
                <button class="close-btn" onclick="closeAddressModal()">&times;</button>
            </div>
            
            <div class="address-list" id="addressList">
                <div class="address-item selected" data-id="1">
                    <h4>Trần Đăng - 0915378844</h4>
                    <p>4449, Nguyễn Cửu Phú, Phường Tân Tạo A, Quận Bình Tân, Hồ Chí Minh</p>
                    <div class="address-tags">
                        <span class="address-tag tag-home">Nhà riêng</span>
                        <span class="address-tag tag-default">Địa chỉ mặc định</span>
                    </div>
                </div>
            </div>

            <div style="margin-top: 20px;">
                <button class="btn btn-link" onclick="openAddAddressModal()">
                    <span style="margin-right: 5px;">+</span> Thêm địa chỉ mới
                </button>
            </div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeAddressModal()">Hủy</button>
                <button class="btn btn-primary" onclick="selectAddress()">Tiếp tục</button>
            </div>
        </div>
    </div>

    <!-- Modal thêm địa chỉ mới -->
    <div id="addAddressModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Thêm địa chỉ mới</h3>
                <button class="close-btn" onclick="closeAddAddressModal()">&times;</button>
            </div>

            <form id="addAddressForm">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label required">Số điện thoại</label>
                        <div style="display: flex; gap: 10px;">
                            
                            <input type="tel" class="form-control" id="phoneNumber" placeholder="Nhập số điện thoại" maxlength="10" pattern="0[0-9]{9}" onchange="toggleLocationFields()" oninput="validatePhone()">
                        </div>
                        <div id="phoneError" style="color: #e74c3c; font-size: 13px; margin-top: 3px; display: none;"></div>
                    </div>
                    <div class="form-group">
                        <label class="form-label required">Họ và tên</label>
                        <input type="text" class="form-control" id="fullName" placeholder="Nhập họ và tên" onchange="toggleLocationFields()" oninput="validateName()">
                        <div id="nameError" style="color: #e74c3c; font-size: 13px; margin-top: 3px; display: none;"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label required">Chọn Tỉnh/TP</label>
                    <select class="form-control" id="province" disabled onchange="loadDistricts()">
                        <option value="">Chọn Tỉnh/Thành phố</option>
                    </select>
                    <div class="form-hint" id="provinceHint">Vui lòng nhập số điện thoại và họ tên trước</div>
                </div>

                <div class="form-group">
                    <label class="form-label required">Chọn Quận/Huyện (Phường/Xã)</label>
                    <select class="form-control" id="district" disabled onchange="loadWards()">
                        <option value="">Chọn Quận/Huyện</option>
                    </select>
                    <div class="form-hint" id="districtHint">Vui lòng chọn Tỉnh/TP trước</div>
                </div>

                <div class="form-group">
                    <label class="form-label required">Số nhà + Tên đường</label>
                    <input type="text" class="form-control" id="streetAddress" placeholder="Ví dụ: 123 Nguyễn Văn A" disabled>
                    <div class="form-hint" id="streetHint">Vui lòng chọn Quận/Huyện trước</div>
                </div>

                <div class="address-type-toggle">
                    <span>Chọn loại địa chỉ:</span>
                    <button type="button" class="toggle-btn active" data-type="home">Nhà riêng</button>
                    <button type="button" class="toggle-btn" data-type="office">Công ty</button>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="setDefault">
                    <label for="setDefault">Đặt làm địa chỉ mặc định</label>
                </div>
            </form>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeAddAddressModal()">Hủy</button>
                <button class="btn btn-primary" onclick="submitNewAddress()">Tiếp tục</button>
            </div>
        </div>
    </div>

    <!-- Modal xác nhận -->
    <div id="confirmModal" class="modal confirmation-modal">
        <div class="modal-content">
            <div class="confirmation-icon">✓</div>
            <h3 style="margin-bottom: 15px;">Xác nhận thêm địa chỉ</h3>
            <p style="margin-bottom: 25px; color: #666;">Địa chỉ mới đã được thêm thành công!</p>
            <button class="btn btn-primary" onclick="confirmAddAddress()">OK</button>
        </div>
    </div>


    <script src="/js/trang_chu/checkout.js"></script>
</body>
</html>